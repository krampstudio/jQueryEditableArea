{"ts":1347110729094,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"(function( $ ){\n    \"use strict\";\n    \n    var EditableArea = {\n        _opts : {\n            save : {\n                label : 'Valider'\n            },\n            cancel : {\n                label : 'Annuler'\n            },\n\t\t\tcssClass : 'editable'\n        },\n        _editing : [],\n        _isEditing: function(id){\n            return ($.inArray(id, EditableArea._editing) > -1);\n        },\n        setupArea: function(options){      \n            var opts = $.extend(true, {}, EditableArea._opts, options);\n            return this.each(function() {\n                var $elt = $(this);\n                var id = $elt.attr('id');\n                if(!id){\n                    $.error('editable areas must be identified by a unique id');   \n                }\n\t\t\t\tif(!$elt.hasClass(opts.cssClass)){\n\t\t\t\t\t$elt.addClass(opts.cssClass);\n\t\t\t\t}\n                $elt.mouseover(function(){\n                    if(!EditableArea._isEditing(id)){\n                        $elt.css('cursor', 'pointer');\n                        if(opts.hoverClass){\n                            $elt.addClass(opts.hoverClass);\n                        }\n                    }\n                })\n                .mouseout(function(){\n                    $elt.css('cursor', 'default');\n                    if(opts.hoverClass){\n                        $elt.removeClass(opts.hoverClass);\n                    }\n                })\n                .click(function(){\n                    \n                    if(!EditableArea._isEditing(id)){\n                        EditableArea._editing.push(id);\n                        var type = ($elt.children().length === 0) ? 'text' : 'wysiwyg';\n                        var $editable, baseValue;\n                        if (type == 'text') {\n                            $editable = $(\"<input type='text' />\");\n                            baseValue = $elt.text();\n                            $editable.val(baseValue)\n                                    .attr('id', id + '_edit')\n                                    .width(parseInt($elt.width(), 10) - 20 + 'px');\n                            $elt.empty().append($editable);\n                        }\n                        else{\n                            $editable = $(\"<textarea />\");\n                            baseValue = $elt.html();\n                            $editable.val(baseValue)\n                                    .attr('id', id + '_edit')\n                                    .width(parseInt($elt.width(), 10) - 20 + 'px');\n                            $elt.empty().append($editable);\n                            $editable.wysiwyg();\n                        }\n                        $elt.data('editableArea', {\n                            type : type,\n                            baseValue : baseValue\n                        });\n                        if(opts.fieldClass){\n                            $elt.addClass(opts.fieldClass);\n                        }\n                        var saveCtrlId = id + '_edit_control_save',\n                            cancelCtrlId = id + '_edit_control_cancel';\n                        var $controlBox = $(\"<div class='editablearea-control-box'>\" +\n                                                \"<a id='\" + cancelCtrlId + \"' href='#'>\"+opts.cancel.label+\"</a>\" +\n                                                \"<a id='\" + saveCtrlId + \"' href='#'>\"+opts.save.label+\"</a>\" +\n                                            \"</div>\");\n                        $elt.append($controlBox);\n                        if($.ui){   //check if jquery-ui is loaded\n                            $('a', $controlBox).button();\n                        }\n                        $('#' + saveCtrlId).click(function(){\n                            var id = $(this).attr('id').replace('_edit_control_save', '');\n                            var $elt = $('#' + id);\n                            $elt.trigger('save.editableArea', $elt.editableArea('getValue'));\n                            $elt.trigger('close.editableArea');\n                        });\n                         $('#' + cancelCtrlId).click(function(){\n                            var id = $(this).attr('id').replace('_edit_control_cancel', '');\n                            $('#' + id).editableArea('destroy');\n                        });\n                    }\n                })\n                .on('close.editableArea', function(){\n                    $(this).editableArea('closeArea');\n                });\n            });\n        },\n        closeArea : function(value){\n            return this.each(function() {\n                var $elt = $(this);\n                if(EditableArea._isEditing($elt.attr('id'))){\n                    value = value || $elt.editableArea('getValue');\n                    var data = $elt.data('editableArea');\n                    $elt.empty();\n                    switch(data.type){\n                        case 'wysiwyg' : $elt.html(value); break;\n                        case 'text' : $elt.text(value); break;\n                    }\n                   setTimeout(function(){   //isn't called if not in a settimeout; don't know why!\n                        var index = EditableArea._editing.indexOf($elt.attr('id'));\n                        EditableArea._editing.splice(index,1);\n                   }, 1);\n                }\n            }); \n        },\n        getValue : function(){\n            var values = [];\n            this.each(function() {\n                var $elt = $(this);\n                if(EditableArea._isEditing($elt.attr('id'))){\n                    var $editable = $('#' +$elt.attr('id') + '_edit', $elt);\n                    var data = $elt.data('editableArea');\n                    switch(data.type){\n                    case 'text': \n                        values.push($editable.val());\n                        break;\n                    case 'wysiwyg': \n                        values.push($editable.wysiwyg('getContent'));\n                        break;\n                    }\n                }\n            }); \n            \n            return (values.length === 1) ? values[0] : values;\n        },\n        destroy : function(){\n            this.each(function() {\n                var $elt = $(this); console.log('destroy')\n                if(EditableArea._isEditing($elt.attr('id'))){\n                    var data = $elt.data('editableArea');\n                    $elt.editableArea('closeArea', data.baseValue);\n                }\n                $elt.off('.editableArea');\n            });\n        }\n    };\n\n    $.fn.editableArea = function( method ) {        \n        if ( EditableArea[method] ) {\n          return EditableArea[method].apply( this, Array.prototype.slice.call( arguments, 1 ));\n        } else if ( typeof method === 'object' || ! method ) {\n          return EditableArea.setupArea.apply( this, arguments );\n        } else {\n          $.error( 'Method ' +  method + ' does not exist on jQuery.editableArea' );\n        }    \n    };\n\n})( jQuery );\n"]],"start1":0,"start2":0,"length1":0,"length2":6947}]],"length":6947}
{"contributors":[],"silentsave":true,"ts":1347110825862,"patch":[[{"diffs":[[0,"method] ) {\n"],[1,"            \n"],[0,"          re"]],"start1":6572,"start2":6572,"length1":24,"length2":37}]],"length":6960,"saved":false}
{"ts":1347110826558,"patch":[[{"diffs":[[0,"od] ) {\n        "],[-1,"    "],[0,"\n          retur"]],"start1":6576,"start2":6576,"length1":36,"length2":32}]],"length":6956,"saved":false}
{"ts":1347110827287,"patch":[[{"diffs":[[0,"od] ) {\n        "],[1,"    "],[0,"\n          retur"]],"start1":6576,"start2":6576,"length1":32,"length2":36}]],"length":6960,"saved":false}
{"ts":1347110827952,"patch":[[{"diffs":[[0,") {\n            "],[1,"wysiwyg"],[0,"\n          retur"]],"start1":6580,"start2":6580,"length1":32,"length2":39}]],"length":6967,"saved":false}
{"ts":1347110835503,"patch":[[{"diffs":[[0,"        "],[-1,"wysiwyg"],[0,"\n       "]],"start1":6588,"start2":6588,"length1":23,"length2":16}]],"length":6960,"saved":false}
{"ts":1347110836472,"patch":[[{"diffs":[[0,") {\n            "],[1,"if(/^_/.test(method)){\n    \t\t\t$.error( 'Trying to call a private method ' +  method + ' on jQuery.pluginName' );\n\t\t\t} else {"],[0,"\n          retur"]],"start1":6580,"start2":6580,"length1":32,"length2":156}]],"length":7084,"saved":false}
{"ts":1347110838051,"patch":[[{"diffs":[[0," );\n\t\t\t} else {\n"],[1,"                \n"],[0,"          return"]],"start1":6705,"start2":6705,"length1":32,"length2":49}]],"length":7101,"saved":false}
{"ts":1347110838973,"patch":[[{"diffs":[[0,"               \n"],[1,"            \n"],[0,"          return"]],"start1":6722,"start2":6722,"length1":32,"length2":45}]],"length":7114,"saved":false}
{"ts":1347110840052,"patch":[[{"diffs":[[0,"       \n"],[-1,"            "],[1,"\t\t\t}"],[0,"\n       "]],"start1":6730,"start2":6730,"length1":28,"length2":20}]],"length":7106,"saved":false}
{"ts":1347110844545,"patch":[[{"diffs":[[0,"    "],[-1,"return EditableArea[method].apply( this, Array.prototype.slice.call( arguments, 1 ));"],[0,"\n   "]],"start1":6749,"start2":6749,"length1":93,"length2":8}]],"length":7021,"saved":false}
{"ts":1347110846598,"patch":[[{"diffs":[[0,"        "],[1,"return EditableArea[method].apply( this, Array.prototype.slice.call( arguments, 1 ));      "],[0,"\n\t\t\t}\n  "]],"start1":6729,"start2":6729,"length1":16,"length2":107}]],"length":7112,"saved":false}
{"ts":1347110848716,"patch":[[{"diffs":[[0,"  \n\t\t\t}\n"],[-1,"          \n"],[0,"        "]],"start1":6826,"start2":6826,"length1":27,"length2":16}]],"length":7101,"saved":false}
{"ts":1347110852922,"patch":[[{"diffs":[[0,"){\n    \t"],[-1,"\t\t"],[0,"$.error("]],"start1":6616,"start2":6616,"length1":18,"length2":16}]],"length":7099,"saved":false}
{"ts":1347110853729,"patch":[[{"diffs":[[0,")){\n    "],[-1,"\t"],[0,"$.error("]],"start1":6615,"start2":6615,"length1":17,"length2":16}]],"length":7098,"saved":false}
{"ts":1347110855449,"patch":[[{"diffs":[[0,"t(method)){\n"],[1,"            "],[0,"    $.error("]],"start1":6607,"start2":6607,"length1":24,"length2":36}]],"length":7110,"saved":false}
{"ts":1347110859648,"patch":[[{"diffs":[[0,"d ) {\n          "],[1,"  "],[0,"return EditableA"]],"start1":6900,"start2":6900,"length1":32,"length2":34}]],"length":7112,"saved":false}
{"ts":1347110861559,"patch":[[{"diffs":[[0,"lse {\n          "],[1,"  "],[0,"$.error( 'Method"]],"start1":6985,"start2":6985,"length1":32,"length2":34}]],"length":7114,"saved":false}
